<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Uai Dashboard</title>
  <link rel="stylesheet" href="https://use.typekit.net/lvv6fgs.css">
  <style>
    :root {
      --brand-font: 'omnes-variable', 'Segoe UI', system-ui, sans-serif;
      font-family: var(--brand-font);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    
    body {
      background-color: #760f0e; /* Vinho */
      color: #f8f8f8;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }

    /* HEADER */
    /* --- NOVO HEADER ORB (Medalhão) --- */
    header {
      padding: 0.5rem 2rem;
      height: 70px;
      background-color: #760f0e;
      border-bottom: 1px solid #f1d286;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 100;
    }

    /* Logo Deformada (Orb) */
    .header-logo-orb {
      position: absolute;
      top: 0;
      left: 30px;
      width: 110px;
      height: 120px;
      background: radial-gradient(circle at 50% 100%, #760f0e 60%, #5a0807 100%);
      border-radius: 0 0 55px 55px;
      border-left: 1px solid #f1d286;
      border-right: 1px solid #f1d286;
      border-bottom: 3px solid #f1d286;
      box-shadow: 0 10px 25px rgba(0,0,0,0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      padding-top: 15px;
      z-index: 101;
      transition: transform 0.3s ease;
    }
    
    .header-logo-orb:hover { transform: translateY(5px); }

    .header-logo-orb img {
      height: 85px;
      width: auto;
      filter: drop-shadow(0 5px 5px rgba(0,0,0,0.3));
    }

    /* Navegação empurrada para a direita */
    nav { 
      margin-left: 140px; 
      display: flex; 
      gap: 20px; 
    }
    nav a {
      text-decoration: none;
      color: #f8f8f8;
      font-weight: 600;
      font-size: 0.9rem;
      text-transform: uppercase;
      opacity: 0.7;
      transition: all 0.2s;
    }
    nav a:hover { opacity: 1; color: #f1d286; }
    nav a.active { opacity: 1; color: #f1d286; border-bottom: 2px solid #f1d286; padding-bottom: 2px; }
    nav a {
      text-decoration: none;
      color: #f8f8f8;
      font-weight: 600;
      font-size: 0.9rem;
      text-transform: uppercase;
      opacity: 0.7;
      transition: all 0.2s;
    }
    nav a:hover { opacity: 1; color: #f1d286; }
    nav a.active { opacity: 1; color: #f1d286; border-bottom: 2px solid #f1d286; padding-bottom: 2px; }

    main {
      flex: 1;
      padding: 2rem;
      max-width: 1100px;
      margin: 0 auto;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 40px;
    }

    /* CONTROLE SUPERIOR (KPI + FILTRO) */
    .dashboard-controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: transparent;
      border: none;
      border-radius: 0;
      padding: 0;
      gap: 20px;
      flex-wrap: wrap;
    }

    .kpi-group {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }

    .single-kpi {
      display: flex;
      flex-direction: column;
    }
    .kpi-card {
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(241, 210, 134, 0.3);
      border-radius: 16px;
      padding: 16px 20px;
      min-width: 240px;
    }
    .kpi-label { font-size: 0.9rem; color: #ccc; text-transform: uppercase; letter-spacing: 0.5px; font-family: var(--brand-font); }
    .kpi-value { font-size: 2.5rem; font-weight: bold; color: #f1d286; margin: 5px 0; font-family: var(--brand-font); }
    .kpi-sub { font-size: 0.85rem; color: #ccc; opacity: 0.7; font-family: var(--brand-font); }

    /* BOTÃO TOGGLE (FILTRO) */
    .filter-group {
      display: flex;
      gap: 10px;
      background: rgba(255,255,255,0.05);
      padding: 5px;
      border-radius: 30px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .filter-btn {
      background: transparent;
      border: none;
      color: #ccc;
      padding: 10px 25px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 650;
      font-size: 1.1rem;
      text-transform: uppercase;
      transition: all 0.3s ease;
      font-family: var(--brand-font);
    }

    .filter-btn:hover { color: #fff; }

    .filter-btn.active {
      background: #f1d286;
      color: #760f0e;
      box-shadow: 0 2px 10px rgba(241, 210, 134, 0.2);
    }

    /* SEÇÕES DE GRÁFICOS */
    .chart-section {
      background: rgba(0, 0, 0, 0.1);
      border-radius: 16px;
      padding: 25px;
      border: 1px solid rgba(255, 255, 255, 0.05);
      display: flex;
      flex-direction: column;
      position: relative;
    }
    
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      border-left: 4px solid #f1d286;
      padding-left: 15px;
    }

    .section-title {
      font-size: 1.6rem;
      color: #f1d286;
      margin: 0;
      font-weight: 600;
    }
    
    .section-tag {
      font-size: 0.8rem;
      color: #f8f8f8;
      background: rgba(255,255,255,0.1);
      padding: 5px 12px;
      border-radius: 20px;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 1px;
    }

    /* ETIQUETA DE ALERTA (Bottom-Right) */
    .warning-badge {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      background: #d62828;
      border: 1px solid #ff5c5c;
      color: #fff;
      border-radius: 6px;
      position: absolute;
      bottom: 25px;
      right: 25px;
      top: auto;
      left: auto;
      margin: 0;
      opacity: 0;
      transform: translateX(20px);
      pointer-events: none;
      z-index: 20;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    /* ÍCONE */
    .badge-icon {
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 16px;
      flex-shrink: 0;
    }

    /* TEXTO (Expande da direita para a esquerda) */
    .badge-text {
      max-width: 0;
      overflow: hidden;
      white-space: nowrap;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      opacity: 0;
      transition: max-width 0.4s cubic-bezier(0.4, 0, 0.2, 1) 0.1s,
                  opacity 0.3s ease 0.1s,
                  padding-left 0.3s ease 0.1s;
    }

    .chart-section:hover .warning-badge {
      opacity: 1;
      transform: translateX(0);
      pointer-events: auto;
    }

    /* 2. Expande o Texto (Mais compacto) */
    .chart-section:hover .badge-text {
      max-width: 220px;
      opacity: 1;
      padding-left: 6px; /* Reduzido para ficar bem próximo ao ícone */
      margin-right: 5px;
    }

    /* EFEITOS DE INTERAÇÃO NOS GRÁFICOS */
    .active-dot {
      fill: #ffffff !important;
      filter: drop-shadow(0 0 8px rgba(241, 210, 134, 0.8));
      stroke: #fff !important;
      stroke-width: 3px;
      r: 7px !important;
      transition: all 0.15s ease-out;
      cursor: crosshair;
    }

    .glow-path {
      filter: blur(3px);
      stroke: #ffffff;
      stroke-width: 5px;
      stroke-linecap: round;
      opacity: 1; /* Intensidade máxima */
      pointer-events: none;
      mix-blend-mode: screen;
    }

    .overlay-rect {
      fill: transparent;
      cursor: crosshair;
    }

    .chart-box {
      width: 100%;
      height: 300px;
      position: relative;
    }

    /* D3 Styles */
    .axis text { fill: #ccc; font-size: 12px; font-family: var(--brand-font); }
    .axis path, .axis line { stroke: rgba(255,255,255,0.1); }
    .value-label { font-family: var(--brand-font); font-weight: 700; }

    /* Animação Jelly (Gelatina ao Clique) */
    /* Animação Jelly Otimizada (Rápida e Sutil) */
    @keyframes jelly-hit {
      0%   { transform: scale(1, 1); }
      15%  { transform: scale(1.03, 0.97); }
      30%  { transform: scale(0.98, 1.02); }
      45%  { transform: scale(1.01, 0.99); }
      60%  { transform: scale(0.99, 1.01); }
      100% { transform: scale(1, 1); }
    }

    .jelly-effect {
      animation: jelly-hit 0.4s ease-out;
      transform-origin: center bottom;
      transform-box: fill-box;
    }

    .bg-bar {
      cursor: pointer;
      pointer-events: all;
    }
  
    /* --- CONFIGURAÇÃO PARA PDF DIGITAL (Dark Mode) --- */
    @media print {
      /* 1. Força o navegador a MANTER o fundo colorido e gráficos */
      body {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        background-color: #760f0e !important; /* Fundo Vinho Obrigatório */
        color: #f8f8f8 !important; /* Texto Claro */
      }

      /* 2. Remove apenas elementos de interface que não funcionam em PDF */
      #atlas-guide,        /* Widget de Cores */
      #atlas-guide-toggle, /* Botão do Widget */
      .filter-group,       /* Botões de Filtro (Loja/Revenda) */
      .shortcut-btn .arrow-icon, /* Setas de link */
      .warning-badge {     /* Alertas flutuantes */
        display: none !important;
      }

      /* 3. Garante que os Cards não sejam cortados ao meio na quebra de página */
      .kpi-card, .issue-card, .chart-section, .content-section, .single-kpi, .budget-section {
        break-inside: avoid;
        page-break-inside: avoid;
      }

      /* 4. Ajustes de Layout para PDF */
      main { 
        width: 100% !important; 
        max-width: none !important; 
        margin: 0 !important; 
        padding: 20px !important;
      }
      
      header {
        position: static; /* Solta o header para não cobrir conteúdo */
        border-bottom: 2px solid #f1d286;
      }
      
      /* Mantém a logo Orb visível e bonita */
      .header-logo-orb {
        position: absolute !important; 
        box-shadow: none !important; /* Remove sombra pesada no PDF */
      }
    }
</style>
</head>
<body>

  <header>
    <div class="header-logo-orb">
      <img src="SVG/UaiLogoNoite.svg" alt="Atlas System v1.0">
    </div>
        <nav>
      <a href="visibilidade.html">Visibilidade</a>
      <a href="resultados.html" class="active">Anúncios</a>
      <a href="vendas.html">Vendas</a>
      <a href="operacao.html">Operação</a>
      <a href="planoDeAcao.html">Plano de Ação</a>
      <a href="conteudo.html">Conteúdo</a>
    </nav>
  </header>

  <main>

    <div class="page-header">
      <h2 style="color: #f8f8f8; font-size: 2.4rem; margin: 0 0 20px 0;">Performance dos Anúncios</h2>
    </div>

    <div class="dashboard-controls">
      <div class="kpi-group">
        <div class="single-kpi kpi-card">
          <span class="kpi-label">Vendas via Ads</span>
          <span class="kpi-value" id="display-ads-sales">R$ --</span>
          <span class="kpi-sub">Receita atribuída aos anúncios</span>
        </div>
        <div class="single-kpi kpi-card">
          <span class="kpi-label">Orçamento de campanha</span>
          <span class="kpi-value" id="display-investment">R$ --</span>
          <span class="kpi-sub">Valor aplicado no período (19 Nov - 06 Jan)</span>
        </div>
      </div>

      <div class="filter-group">
        <button class="filter-btn active" onclick="setFilter('loja')" id="btn-loja">Loja</button>
        <button class="filter-btn" onclick="setFilter('revenda')" id="btn-revenda">Distribuidora</button>
      </div>
    </div>

    <div class="chart-section">
      <div class="section-header">
        <h2 class="section-title">Quanto custou cada mensagem?</h2>
        <span class="section-tag">Análise de CPR</span>
      </div>
      <div id="chart-cpc" class="chart-box"></div>
    </div>

    <div class="chart-section">
      <div class="section-header">
        <h2 class="section-title">Quanto custou aparecer 1.000 vezes?</h2>
        <span class="section-tag">Análise de CPM</span>
      </div>
      <div id="chart-cpm" class="chart-box"></div>
    </div>

  </main>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="NAJA® Scope/NAJA® Scope.js"></script>

  <script>
    // --- DADOS (SIMULADOS) PARA OS DOIS CENÁRIOS ---
    const DB = {
      loja: {
        investment: "R$ 345",
        adsSales: "R$ ?",
        cpc: [
          { label: '19/11 - 25/11', clicks: 144, val: 0.83 },
          { label: '26/11 - 02/12', clicks: 36, val: 2.42 },
          { label: '03/12 - 09/12', clicks: 13, val: 10.00 },
          { label: '10/12 - 16/12', clicks: null, val: null },
          { label: '17/12 - 23/12', clicks: null, val: null },
          { label: '24/12 - 30/12', clicks: null, val: null },
          { label: '31/12 - 06/01', clicks: null, val: null }
        ],
        cpm: [
          { label: '19/11 - 25/11', imps: 17000, val: 17.00 },
          { label: '26/11 - 02/12', imps: 15000, val: 15.00 },
          { label: '03/12 - 09/12', imps: 36000, val: 36.00 },
          { label: '10/12 - 16/12', imps: null, val: null },
          { label: '17/12 - 23/12', imps: null, val: null },
          { label: '24/12 - 30/12', imps: null, val: null },
          { label: '31/12 - 06/01', imps: null, val: null }
        ],
        cpa: [
          { label: 'Sem 1', val: 45.50 }, 
          { label: 'Sem 2', val: 42.10 },
          { label: 'Sem 3', val: 38.00 }, // Otimizou
          { label: 'Sem 4', val: 35.50 }
        ],
        roas: [ // Multiplicador alto (Varejo)
          { label: 'S1', val: 3.2 }, { label: 'S2', val: 4.1 },
          { label: 'S3', val: 5.5 }, { label: 'S4', val: 6.8 }
        ],
        roi: [ // % de Lucro
          { label: 'S1', val: 120 }, { label: 'S2', val: 180 },
          { label: 'S3', val: 250 }, { label: 'S4', val: 310 }
        ],
        metaCpa: 40.00
      },
      revenda: {
        investment: "R$ 1.540", // Investimento menor no B2B/Revenda
        adsSales: "R$ 2.001",
        cpc: [ // CPC mais caro (B2B costuma ser)
          { label: '19/11 - 25/11', clicks: null, val: null },
          { label: '26/11 - 02/12', clicks: null, val: null },
          { label: '03/12 - 09/12', clicks: 101, val: 1.29 },
          { label: '10/12 - 16/12', clicks: 181, val: 1.83 },
          { label: '17/12 - 23/12', clicks: 200, val: 1.89 },
          { label: '24/12 - 30/12', clicks: 185, val: 2.00 },
          { label: '31/12 - 06/01', clicks: 228, val: 1.83 }
        ],
        cpm: [ // CPM mais caro (Público segmentado)
          { label: '19/11 - 25/11', imps: null, val: null },
          { label: '26/11 - 02/12', imps: null, val: null },
          { label: '03/12 - 09/12', imps: 20000, val: 20.00 },
          { label: '10/12 - 16/12', imps: 20000, val: 20.00 },
          { label: '17/12 - 23/12', imps: 18800, val: 18.80 },
          { label: '24/12 - 30/12', imps: 18800, val: 18.80 },
          { label: '31/12 - 06/01', imps: 18500, val: 18.50 }
        ],
        cpa: [ // CPA mais alto (Lead qualificado)
          { label: 'Sem 1', val: 85.00 }, 
          { label: 'Sem 2', val: 75.00 },
          { label: 'Sem 3', val: 65.00 }, 
          { label: 'Sem 4', val: 60.00 }
        ],
        roas: [ // ROAS geralmente maior em B2B pelo ticket alto
          { label: 'S1', val: 5.0 }, { label: 'S2', val: 6.5 },
          { label: 'S3', val: 8.0 }, { label: 'S4', val: 9.2 }
        ],
        roi: [ // ROI alto
          { label: 'S1', val: 200 }, { label: 'S2', val: 350 },
          { label: 'S3', val: 450 }, { label: 'S4', val: 500 }
        ],
        metaCpa: 70.00
      }
    };

    function formatTotalAbsolute(val) {
      if (val == null) return '-';
      if (val >= 1000) return (val / 1000).toFixed(1).replace('.0','') + 'k';
      return val;
    }

    let currentData = DB.loja; // Estado inicial
    const COLORS = {
      gold: "#f1d286",
      deep: "#760f0e",
      bar: "#f8f8f8"
    };

    // --- FUNÇÃO DE CONTROLE (FILTRO) ---
    function setFilter(type) {
      // Atualiza botões
      document.getElementById('btn-loja').classList.remove('active');
      document.getElementById('btn-revenda').classList.remove('active');
      document.getElementById('btn-' + type).classList.add('active');

      // Atualiza Dados
      currentData = DB[type];
      
      // Atualiza KPI
      document.getElementById('display-investment').innerText = currentData.investment;
      document.getElementById('display-ads-sales').innerText = currentData.adsSales;

      // Re-renderiza gráficos
      renderAllCharts();
    }

    // --- RENDERIZADORES D3 ---
    // --- RENDERIZADOR UNIVERSAL COM EFEITOS DE LUZ ---
    function renderChart(containerId, data, config) {
      const container = d3.select(containerId);
      container.selectAll("*").remove();

      if (!data || data.length === 0) return;

      const rect = container.node().getBoundingClientRect();
      const width = rect.width;
      const height = rect.height;
      const margin = { top: 30, right: 30, bottom: 40, left: 40 };
      const maskId = `mask-${containerId.replace('#', '')}`;
      const uniqueId = containerId.replace('#', '');

      const svg = container.append('svg')
        .attr('width', width)
        .attr('height', height);

      const defs = svg.append("defs");
      const mask = defs.append("mask").attr("id", maskId);
      mask.append("rect").attr("x", 0).attr("y", 0).attr("width", width).attr("height", height).attr("fill", "black");
      const maskCircle = mask.append("circle")
        .attr("cx", -100).attr("cy", -100).attr("r", 18)
        .attr("fill", "white").attr("filter", "blur(5px)");

      const x = d3.scaleBand()
        .range([margin.left, width - margin.right])
        .domain(data.map(d => d.label))
        .padding(0.45);

      const valAccessor = d => d.val;
      const hasValue = d => valAccessor(d) != null;
      const yVal = d3.scaleLinear()
        .range([height - margin.bottom, margin.top])
        .domain([0, d3.max(data, valAccessor) * 1.3]);

      const volAccessor = d => config.yKey ? d[config.yKey] : d.val;
      const yVol = d3.scaleLinear()
        .range([height - margin.bottom, margin.top])
        .domain([0, d3.max(data, volAccessor) * 1.3]);

      const axisGroup = svg.append("g")
        .attr("transform", `translate(0,${height - margin.bottom})`)
        .attr("class", "axis");

      const axisGenerator = d3.axisBottom(x).tickSize(0).tickPadding(15);
      axisGroup.call(axisGenerator);

      if (config.axisSecondary) {
        const secondaryFormatter = config.axisSecondary.format || (val => val);
        const labelLookup = new Map(data.map(point => [point.label, point]));
        axisGroup.selectAll(".tick").each(function() {
          const tickGroup = d3.select(this);
          const tickText = tickGroup.select("text");
          const label = tickGroup.datum();
          const sourceData = labelLookup.get(label);
          const secondaryValue = sourceData ? config.axisSecondary.getValue(sourceData) : null;
          tickText.append("tspan")
            .attr("x", 0)
            .attr("dy", "1.35em")
            .style("font-size", "11px")
            .style("font-weight", "600")
            .style("fill", "#f1d286")
            .text(secondaryValue != null ? `Total ${secondaryFormatter(secondaryValue)}` : '-');
        });
      }

      svg.selectAll(".bg-bar").data(data).join("rect")
        .attr("class", "bg-bar")
        .attr("id", (d, i) => `bar-${uniqueId}-${i}`)
        .attr("x", d => x(d.label))
        .attr("y", d => yVol(volAccessor(d)))
        .attr("width", x.bandwidth())
        .attr("height", d => height - margin.bottom - yVol(volAccessor(d)))
        .attr("fill", COLORS.bar).attr("opacity", 0.1).attr("rx", 4)
        .style("pointer-events", "none");

      const xCenter = d => x(d.label) + x.bandwidth() / 2;
      const lineGen = d3.line()
        .defined(hasValue)
        .x(xCenter)
        .y(d => yVal(valAccessor(d)))
        .curve(d3.curveMonotoneX);

      svg.append("path")
        .datum(data)
        .attr("d", lineGen)
        .attr("fill", "none")
        .attr("stroke", COLORS.gold)
        .attr("stroke-width", 3)
        .style("pointer-events", "none");

      svg.append("path")
        .datum(data)
        .attr("class", "glow-path")
        .attr("d", lineGen)
        .attr("fill", "none")
        .attr("mask", `url(#${maskId})`);

      const circles = svg.selectAll(".chart-dot").data(data).join("circle")
        .attr("class", "chart-dot")
        .attr("cx", xCenter)
        .attr("cy", d => hasValue(d) ? yVal(valAccessor(d)) : height + 20)
        .attr("r", 5)
        .attr("fill", COLORS.deep)
        .attr("stroke", COLORS.gold)
        .attr("stroke-width", 2)
        .style("pointer-events", "none")
        .attr("visibility", d => hasValue(d) ? "visible" : "hidden");

      const labelData = data.filter(hasValue);
      svg.selectAll(".chart-label").data(labelData).join("text")
        .attr("x", xCenter)
        .attr("y", d => yVal(valAccessor(d)) - 20)
        .attr("text-anchor", "middle")
        .style("fill", COLORS.gold)
        .style("font-size", "18px")
        .style("font-weight", "bold")
        .style("font-family", "var(--brand-font)")
        .text(d => config.format(d.val))
        .style("pointer-events", "none");

      if (config.yKey) {
        svg.selectAll(".bar-label").data(data).join("text")
          .attr("x", xCenter)
          .attr("y", d => yVol(volAccessor(d)) + 18)
          .attr("text-anchor", "middle")
          .style("fill", "rgba(248, 248, 248, 0.85)")
          .style("font-size", "11px")
          .style("font-weight", "600")
          .style("font-family", "var(--brand-font)")
          .text(d => {
            const val = volAccessor(d);
            if (val >= 1000) return (val / 1000).toFixed(1).replace('.0','') + 'k';
            return val;
          })
          .style("pointer-events", "none");
      }

      svg.selectAll(".hit-box").data(data).join("rect")
        .attr("class", "hit-box")
        .attr("x", d => x(d.label))
        .attr("y", margin.top)
        .attr("width", x.bandwidth())
        .attr("height", height - margin.bottom - margin.top)
        .attr("fill", "transparent")
        .style("cursor", "pointer")
        .on("click", function(event, d) {
          event.stopPropagation();
          const index = data.indexOf(d);
          const visualBar = d3.select(`#bar-${uniqueId}-${index}`);
          visualBar.classed("jelly-effect", false);
          setTimeout(() => {
             visualBar.classed("jelly-effect", true);
          }, 10);
        });

      svg.on("mousemove", function(event) {
          const [mx, my] = d3.pointer(event, this);
          maskCircle.attr("cx", mx).attr("cy", my);

          let closestDist = Infinity;
          let closestIdx = -1;

          data.forEach((d, i) => {
            const cx = x(d.label) + x.bandwidth() / 2;
            const dist = Math.abs(mx - cx);
            if (dist < closestDist) {
              closestDist = dist;
              closestIdx = i;
            }
          });

          if (closestDist < 20) {
             circles.classed("active-dot", (_, i) => i === closestIdx);
          } else {
             circles.classed("active-dot", false);
          }
      })
      .on("mouseleave", function() {
          circles.classed("active-dot", false);
          maskCircle.attr("cx", -200).attr("cy", -200);
      });
    }
    function renderAllCharts() {
      renderChart('#chart-cpc', currentData.cpc, {
         yKey: 'clicks',
         format: val => "R$ " + val.toFixed(2),
         axisSecondary: {
           getValue: d => d.clicks,
           format: formatTotalAbsolute
         }
      });

      renderChart('#chart-cpm', currentData.cpm, {
         yKey: 'imps',
         format: val => "R$ " + val.toFixed(2),
         axisSecondary: {
           getValue: d => d.val != null ? d.val * 1000 : null,
           format: formatTotalAbsolute
         }
      });

    }

    // Init
    setFilter('loja');
    window.addEventListener('resize', renderAllCharts);

  </script>

</body>
</html>
